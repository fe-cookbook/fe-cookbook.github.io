<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>axios 使用说明</title>
        <link rel="stylesheet" href="../assets/style.css">
        <link rel="shortcut icon" href="https://fe-cookbook.github.io/favicon.png">
    </head>
    
    <body>
        <div class="app">
        <header class="navbar"><p><a class="logo" href="/">fe-cookbook</a></p>
<div class="menus">
<a class="item" href="/">首页</a>
</div>
</header>
        <aside class="sidebar">
    <ul class="ul-0"><li class="li-1"><p class="a-2">cookbook</p></li><li class="li-1"><p class="a-2">axios</p><ul class="ul-2"><li class="li-3"><a href="axios-index.html" class="a-4">介绍</a></li><li class="li-3"><a href="axios-defaults.html" class="a-4">默认值</a></li><li class="li-3"><a href="axios-instance.html" class="a-4">实例化</a></li><li class="li-3"><a href="axios-constructor.html" class="a-4">构建函数</a></li></ul></li><li class="li-1"><p class="a-2">前端面试</p></li><li class="li-1"><p class="a-2">html/css</p><ul class="ul-2"><li class="li-3"><a href="html-html5.html" class="a-4">html5</a></li></ul></li><li class="li-1"><p class="a-2">javascrpt</p><ul class="ul-2"><li class="li-3"><a href="javascript-promis.html" class="a-4">promise 返回值问题？</a></li><li class="li-3"><a href="javascript-render.html" class="a-4">从输入 URL 到页面加载完成的过程中都发生了什么事情？</a></li><li class="li-3"><a href="javascript-clone.html" class="a-4">深拷贝和浅拷贝？</a></li><li class="li-3"><a href="javascript-isnan.html" class="a-4">怎么判断一个变量是不是 NaN?</a></li><li class="li-3"><a href="javascript-reduce.html" class="a-4">array reduce 返回值是什么？</a></li><li class="li-3"><a href="javascript-vueprototype.html" class="a-4">vue 组件挂载到全局方法？</a></li><li class="li-3"><a href="javascript-constructor.html" class="a-4">构造函数的返回值是什么？</a></li><li class="li-3"><a href="javascript-vueinsertcomponent.html" class="a-4">怎么通过编程的方式而不是<'my-component'>的方式动态的插入 Vue components?</a></li><li class="li-3"><a href="javascript-object_get.html" class="a-4">获取对象路径处的值\_.get(object, a.b.c, default)</a></li><li class="li-3"><a href="javascript-null.html" class="a-4">[typeof null, null instanceof Object]表达式的返回值是什么？</a></li><li class="li-3"><a href="javascript-array_map_parseint.html" class="a-4">["1", "2", "3"].map(parseInt) 返回值是什么？</a></li><li class="li-3"><a href="javascript-debounce.html" class="a-4">什么是防抖和节流？有什么区别？如何实现？</a></li><li class="li-3"><a href="javascript-object_defineproperty.html" class="a-4">Object.defineProperty 了解有多少？什么是属性描述符？</a></li><li class="li-3"><a href="javascript-mutationobserver.html" class="a-4">怎么监视对 DOM 树的变化</a></li><li class="li-3"><a href="javascript-vueerror.html" class="a-4">Vue 是怎么进行错误处理的？</a></li><li class="li-3"><a href="javascript-esmodules.html" class="a-4">ES6 Modules？</a></li><li class="li-3"><a href="javascript-bind.html" class="a-4">实现一个 bind 函数？</a></li></ul></li></ul><ul class="ul-0"><li class="li-1"><p class="a-2">基础知识</p></li><li class="li-1"><p class="a-2">设计模式</p><ul class="ul-2"><li class="li-3"><p class="a-4">创建型模式</p><ul class="ul-4"><li class="li-5"><a href="pattern-factory.html" class="a-6">工厂模式</a></li><li class="li-5"><a href="pattern-abstract-factory.html" class="a-6">抽象工厂模式</a></li><li class="li-5"><a href="pattern-singleton.html" class="a-6">单例模式</a></li><li class="li-5"><p class="a-6">[建造者模式]</p></li><li class="li-5"><p class="a-6">[原型模式]</p></li></ul></li><li class="li-3"><p class="a-4">结构型模式</p><ul class="ul-4"><li class="li-5"><p class="a-6">[适配器模式]</p></li><li class="li-5"><p class="a-6">[桥接模式]</p></li><li class="li-5"><a href="pattern-decotators.html" class="a-6">装饰模式</a></li><li class="li-5"><p class="a-6">[组合模式]</p></li><li class="li-5"><p class="a-6">[外观模式]</p></li><li class="li-5"><p class="a-6">[享元模式]</p></li><li class="li-5"><a href="pattern-proxy.html" class="a-6">代理模式</a></li></ul></li><li class="li-3"><p class="a-4">行为型模式</p><ul class="ul-4"><li class="li-5"><p class="a-6">[模板方法模式]</p></li><li class="li-5"><p class="a-6">[命令模式]</p></li><li class="li-5"><p class="a-6">[迭代器模式]</p></li><li class="li-5"><a href="pattern-publishsubscribe.html" class="a-6">观察者模式</a></li><li class="li-5"><p class="a-6">[中介者模式]</p></li><li class="li-5"><p class="a-6">[备忘录模式]</p></li><li class="li-5"><p class="a-6">[解释器模式]</p></li><li class="li-5"><a href="pattern-state.html" class="a-6">状态模式</a></li><li class="li-5"><a href="pattern-strategy.html" class="a-6">策略模式</a></li><li class="li-5"><p class="a-6">[职责链模式]</p></li><li class="li-5"><p class="a-6">[访问者模式]</p></li></ul></li></ul></li><li class="li-1"><p class="a-2">webpack</p><ul class="ul-2"><li class="li-3"><a href="webpack-index.html" class="a-4">webpack</a></li></ul></li></ul>
    </aside>
        <main class="page"><div class="page-bd">
        <h1>axios 使用说明</h1>
<blockquote>
<p>下面包含 axios 常用场景的使用说明<br>
为了使 axios 尽可能轻量化，通常需要借助其他一些库。下面用例中的许多特性支持可以通过引入其他库来扩充 axios。</p>
</blockquote>
<h3>Promise.prototype.done</h3>
<pre><code class="language-bash">$ npm install axios promise --save
</code></pre>
<pre><code class="language-js"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"promise/polyfill-done"</span>);

axios
  .get(<span class="hljs-string">"http://www.example.com/user"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(response.data);
    <span class="hljs-keyword">return</span> response;
  })
  .done();
</code></pre>
<h3>Promise.prototype.finally</h3>
<pre><code class="language-bash">$ npm install axios promise.prototype.finally --save
</code></pre>
<pre><code class="language-js"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"promise.prototype.finally"</span>).shim();

axios
  .get(<span class="hljs-string">"http://www.example.com/user"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(response.data);
    <span class="hljs-keyword">return</span> response;
  })
  .finally(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"this will always be called"</span>);
  });
</code></pre>
<h3>压缩、解压缩</h3>
<pre><code class="language-bash">$ npm install axios pako --save
</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// client.js</span>
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>);
<span class="hljs-keyword">const</span> pako = <span class="hljs-built_in">require</span>(<span class="hljs-string">"pako"</span>);

<span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">firstName</span>: <span class="hljs-string">"Fred"</span>,
  <span class="hljs-attr">lastName</span>: <span class="hljs-string">"Flintstone"</span>,
};

<span class="hljs-keyword">const</span> data = pako.deflate(<span class="hljs-built_in">JSON</span>.stringify(user), { <span class="hljs-attr">to</span>: <span class="hljs-string">"string"</span> });

axios.post(<span class="hljs-string">"http://127.0.0.1:3333/user"</span>, data).then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
  response.data = <span class="hljs-built_in">JSON</span>.parse(pako.inflate(response.data, { <span class="hljs-attr">to</span>: <span class="hljs-string">"string"</span> }));
  <span class="hljs-built_in">console</span>.log(response.data);
  <span class="hljs-keyword">return</span> response;
});
</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// server.js</span>
<span class="hljs-keyword">const</span> pako = <span class="hljs-built_in">require</span>(<span class="hljs-string">"pako"</span>);
<span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">const</span> url = <span class="hljs-built_in">require</span>(<span class="hljs-string">"url"</span>);

<span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  req.setEncoding(<span class="hljs-string">"utf8"</span>);

  <span class="hljs-keyword">const</span> parsed = url.parse(req.url, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> pathname = parsed.pathname;

  <span class="hljs-keyword">if</span> (pathname === <span class="hljs-string">"/user"</span>) {
    <span class="hljs-keyword">let</span> data = <span class="hljs-string">""</span>;
    req.on(<span class="hljs-string">"data"</span>, (chunk) =&gt; {
      data += chunk;
    });

    req.on(<span class="hljs-string">"end"</span>, () =&gt; {
      <span class="hljs-keyword">const</span> user = <span class="hljs-built_in">JSON</span>.parse(pako.inflate(data, { <span class="hljs-attr">to</span>: <span class="hljs-string">"string"</span> }));
      <span class="hljs-built_in">console</span>.log(user);

      res.writeHead(<span class="hljs-number">200</span>, {
        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
      });
      res.end(
        pako.deflate(<span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">result</span>: <span class="hljs-string">"success"</span> }), { <span class="hljs-attr">to</span>: <span class="hljs-string">"string"</span> })
      );
    });
  } <span class="hljs-keyword">else</span> {
    res.writeHead(<span class="hljs-number">404</span>);
    res.end(
      pako.deflate(<span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">result</span>: <span class="hljs-string">"error"</span> }), { <span class="hljs-attr">to</span>: <span class="hljs-string">"string"</span> })
    );
  }
});

server.listen(<span class="hljs-number">3333</span>);
</code></pre>
<h3>JSONP 的支持</h3>
<pre><code class="language-bash">$ npm install jsonp --save
</code></pre>
<pre><code class="language-js"><span class="hljs-keyword">const</span> jsonp = <span class="hljs-built_in">require</span>(<span class="hljs-string">"jsonp"</span>);

jsonp(<span class="hljs-string">"http://www.example.com/foo"</span>, <span class="hljs-literal">null</span>, (err, data) =&gt; {
  <span class="hljs-keyword">if</span> (err) {
    <span class="hljs-built_in">console</span>.error(err.message);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(data);
  }
});
</code></pre>
<div class="page-nav"><a class="next" href="axios-defaults.html">默认值→</a></div>
        </div>
    </main>
        </div>
        <script  src="../assets/app.js"></script>
        <script src="../assets/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
        <footer class="footer"></footer>

    </body>
    </html>